function dotW = DiffEquation(tau,W)
global pick tau_total
if tau > pick + tau_total/100;
    waitbar(tau/tau_total);
    pick = tau;
end
if abs(W(1)*W(5)+W(2)*W(6)+W(3)*W(7)+W(4)*W(8)) > 1e-04 & abs(W(1)^2+W(2)^2+W(3)^2+W(4)^2-W(5)^2-W(6)^2-W(7)^2-W(8)^2) > 1e-04
    close all
    warndlg({'Sorry, PROBABLY either the problem is singular or the point is escaping to infinity (but I am a bit paranoic).';'Compare with Integrate of the Standard method and, in case, disable the Watch falling into singularities in Window menu.';'           KEPLER stops here.'})
    clear DiffEquation
    return
end
dotW = zeros(8,1);
%
% SUBSTITUTIONS
%
 tau = tau-floor(tau);
 U1 = W(1);
 U2 = W(2);
 U3 = W(3);
 U4 = W(4);
 V1 = W(5);
 V2 = W(6);
 V3 = W(7);
 V4 = W(8);
 Ko  = 1/2*(sqrt(U1^2+U2^2+U3^2+U4^2)+sqrt(V1^2+V2^2+V3^2+V4^2));
 G1 = (U2*V3-U3*V2)/Ko;
 G2 = (U3*V1-U1*V3)/Ko;
 G3 = (U1*V2-U2*V1)/Ko;
 A1 = (U4*V1-U1*V4)/Ko;
 A2 = (U4*V2-U2*V4)/Ko;
 A3 = (U4*V3-U3*V4)/Ko;
  x = (Ko-U4*sin(2*pi*tau)+V4*cos(2*pi*tau));
 x1 = (U1*cos(2*pi*tau)+V1*sin(2*pi*tau)-A1);
 x2 = (U2*cos(2*pi*tau)+V2*sin(2*pi*tau)-A2);
 x3 = (U3*cos(2*pi*tau)+V3*sin(2*pi*tau)-A3);
 y1 = (-U1*sin(2*pi*tau)+V1*cos(2*pi*tau))/x;
 y2 = (-U2*sin(2*pi*tau)+V2*cos(2*pi*tau))/x;
 y3 = (-U3*sin(2*pi*tau)+V3*cos(2*pi*tau))/x;
 PI = pi;
%
% EQUATIONS
%
 dotW(1) = V1*(2*pi*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976) - 2*pi*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872)) + A1*(2*pi*sin(2*tau*pi)*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872) - 2*pi*sin(2*tau*pi)*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976)) - 2*Ko*pi*((8646911284549941*x2*cos(2*tau*pi))/144115188075855872 - x*sin(2*tau*pi)*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968)) + 2*G3*pi*((8646911284549941*x1*sin(2*tau*pi))/144115188075855872 - x*cos(2*tau*pi)*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872)) - 2*U4*x*pi*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968); 
 dotW(2) = V2*(2*pi*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976) - 2*pi*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872)) + A2*(2*pi*sin(2*tau*pi)*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872) - 2*pi*sin(2*tau*pi)*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976)) + 2*G3*pi*((8646911284549941*x2*sin(2*tau*pi))/144115188075855872 + x*cos(2*tau*pi)*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968)) + 2*Ko*pi*((8646911284549941*x1*cos(2*tau*pi))/144115188075855872 + x*sin(2*tau*pi)*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872)) - 2*U4*x*pi*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872); 
 dotW(3) = V3*(2*pi*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976) - 2*pi*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872)) + A3*(2*pi*sin(2*tau*pi)*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872) - 2*pi*sin(2*tau*pi)*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976)) - 2*G2*pi*((8646911284549941*x2*sin(2*tau*pi))/144115188075855872 + x*cos(2*tau*pi)*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968)) - 2*G1*pi*((8646911284549941*x1*sin(2*tau*pi))/144115188075855872 - x*cos(2*tau*pi)*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872));
 dotW(4) = V4*(2*pi*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976) - 2*pi*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872)) - Ko*(2*pi*cos(2*tau*pi)*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872) - 2*pi*cos(2*tau*pi)*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976)) - 2*A1*pi*((8646911284549941*x2*sin(2*tau*pi))/144115188075855872 + x*cos(2*tau*pi)*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968)) + 2*A2*pi*((8646911284549941*x1*sin(2*tau*pi))/144115188075855872 - x*cos(2*tau*pi)*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872)) + 2*U1*x*pi*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968) + 2*U2*x*pi*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872);
 dotW(5) = - U1*(2*pi*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976) - 2*pi*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872)) - A1*(2*pi*cos(2*tau*pi)*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872) - 2*pi*cos(2*tau*pi)*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976)) - 2*Ko*pi*((8646911284549941*x2*sin(2*tau*pi))/144115188075855872 + x*cos(2*tau*pi)*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968)) - 2*G3*pi*((8646911284549941*x1*cos(2*tau*pi))/144115188075855872 + x*sin(2*tau*pi)*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872)) - 2*V4*x*pi*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968);
 dotW(6) = 2*Ko*pi*((8646911284549941*x1*sin(2*tau*pi))/144115188075855872 - x*cos(2*tau*pi)*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872)) - A2*(2*pi*cos(2*tau*pi)*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872) - 2*pi*cos(2*tau*pi)*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976)) - 2*G3*pi*((8646911284549941*x2*cos(2*tau*pi))/144115188075855872 - x*sin(2*tau*pi)*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968)) - U2*(2*pi*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976) - 2*pi*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872)) - 2*V4*x*pi*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872);
 dotW(7) = 2*G2*pi*((8646911284549941*x2*cos(2*tau*pi))/144115188075855872 - x*sin(2*tau*pi)*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968)) - A3*(2*pi*cos(2*tau*pi)*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872) - 2*pi*cos(2*tau*pi)*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976)) - U3*(2*pi*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976) - 2*pi*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872)) + 2*G1*pi*((8646911284549941*x1*cos(2*tau*pi))/144115188075855872 + x*sin(2*tau*pi)*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872));
 dotW(8) = 2*A1*pi*((8646911284549941*x2*cos(2*tau*pi))/144115188075855872 - x*sin(2*tau*pi)*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968)) - Ko*(2*pi*sin(2*tau*pi)*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872) - 2*pi*sin(2*tau*pi)*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976)) - U4*(2*pi*((4323455642274735*x1)/36028797018963968 + (8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872 + (2075258708291647*x1^2)/1152921504606846976 + (2075258708291647*x2^2)/1152921504606846976) - 2*pi*((8646911284549941*x1*y2)/144115188075855872 - (8646911284549941*x2*y1)/144115188075855872)) - 2*A2*pi*((8646911284549941*x1*cos(2*tau*pi))/144115188075855872 + x*sin(2*tau*pi)*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872)) + 2*V1*x*pi*((2075258708291647*x1)/576460752303423488 + (8646911284549941*y2)/144115188075855872 + 4323455642274735/36028797018963968) + 2*V2*x*pi*((2075258708291647*x2)/576460752303423488 - (8646911284549941*y1)/144115188075855872);
