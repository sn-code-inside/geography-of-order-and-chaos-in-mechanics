function [x, y] = zw2xy(z, w)
z1 = z(1);
z2 = z(2);
z3 = z(3);
z4 = z(4);
w1 = w(1);
w2 = w(2);
w3 = w(3);
w4 = w(4);
x1 =  2*z1*z3 + 2*z2*z4;
x2 =  2*z2*z3 - 2*z1*z4;
x3 = -z1^2 - z2^2 + z3^2 + z4^2;
y1 =  (z1*w3 + z2*w4 + z3*w1 + z4*w2)/(z1^2 + z2^2 + z3^2 + z4^2);
y2 = -(z1*w4 - z2*w3 - z3*w2 + z4*w1)/(z1^2 + z2^2 + z3^2 + z4^2);
y3 = -(z1*w1 + z2*w2 - z3*w3 - z4*w4)/(z1^2 + z2^2 + z3^2 + z4^2);
x = [x1 x2 x3];
y = [y1 y2 y3];