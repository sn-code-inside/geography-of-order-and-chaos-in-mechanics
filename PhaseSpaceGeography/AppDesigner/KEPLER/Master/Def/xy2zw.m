function [z, w] = xy2zw(x_vec, y_vec)
x = sqrt(x_vec*x_vec');
x1 = x_vec(1);
x2 = x_vec(2);
x3 = x_vec(3);
y1 = y_vec(1);
y2 = y_vec(2);
y3 = y_vec(3);
z1 = sqrt(x)*sin(0.5*acos(x3/x))*cos(0.5*atan2(x2,x1));
z2 = sqrt(x)*sin(0.5*acos(x3/x))*sin(0.5*atan2(x2,x1));
z3 = sqrt(x)*cos(0.5*acos(x3/x))*cos(0.5*atan2(x2,x1));
z4 = -sqrt(x)*cos(0.5*acos(x3/x))*sin(0.5*atan2(x2,x1));
w1 = -y3*z1+y1*z3-y2*z4;
w2 = -y3*z2+y1*z4+y2*z3;
w3 =  y1*z1+y2*z2+y3*z3;
w4 =  y1*z2-y2*z1+y3*z4;
z = [z1 z2 z3 z4];
w = [w1 w2 w3 w4];