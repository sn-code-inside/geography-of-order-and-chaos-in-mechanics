 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
qp2uv
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%              Write inputL.txt
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
L = sqrt(sm_ax);
cos_l_Pauli = (v(:,3).^2+v(:,4).^2-u(:,3).^2-u(:,4).^2)...    
    ./sqrt((2*u(:,3).*v(:,3)+2*u(:,4).*v(:,4)).^2+(v(:,3).^2+v(:,4).^2-u(:,3).^2-u(:,4).^2).^2);    
sin_l_Pauli = (2*u(:,3).*v(:,3)+2*u(:,4).*v(:,4))...    
    ./sqrt((2*u(:,3).*v(:,3)+2*u(:,4).*v(:,4)).^2+(v(:,3).^2+v(:,4).^2-u(:,3).^2-u(:,4).^2).^2);    
Lx = L.*cos_l_Pauli;    
Ly = L.*sin_l_Pauli;    
%lx = delta.*cos(Delta)+Delta.*sin(Delta);
%ly = -delta.*sin(Delta)+Delta.*cos(Delta);
fid = fopen('FMFT/inputL.txt', 'wt');
fprintf(fid, '%14.10f %14.10f %14.10f\n',...
            [tau'; Lx'; Ly']);
fclose(fid);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%              Write inputS.txt
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
phiS = atan2(S_vec(:,2), S_vec(:,1));
Sx = S_vec(:,3).*cos(phiS);
Sy = S_vec(:,3).*sin(phiS);
fid = fopen('FMFT/inputS.txt', 'wt');
%fprintf(fid, '%14.10f %14.10f %14.10f\n',...
%            [tau'; (S_vec(:,1))'; (S_vec(:,2))']);
fprintf(fid, '%14.10f %14.10f %14.10f\n', [tau'; Sx'; Sy']);       
fclose(fid);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%              Write inputD.txt
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
phiD = atan2(D_vec(:,2), D_vec(:,1));
Dx = D_vec(:,3).*cos(phiD);
Dy = D_vec(:,3).*sin(phiD);
fid = fopen('FMFT/inputD.txt', 'wt');
%fprintf(fid, '%14.10f %14.10f %14.10f\n',...
%            [tau'; (D_vec(:,1))'; (D_vec(:,2))']);
fprintf(fid, '%14.10f %14.10f %14.10f\n', [tau'; Dx'; Dy']);
fclose(fid);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%